<html>
<head><meta http-equiv=Content-Type content="text/html; charset=windows-1252"><link rel=stylesheet href="../jdoc.css" type="text/css"><title>Unicode</title>
</head><body><!--top jump start--><a href="locked_scripts.htm">&gt;&gt;</a>&nbsp;
<a href="boxdraw.htm">&lt;&lt;</a>&nbsp;
<a href="../user/contents.htm">Usr</a>&nbsp;
<a href="../primer/contents.htm">Pri</a>&nbsp;
<a href="../jforc/contents.htm">JfC</a>&nbsp;
<a href="../learning/contents.htm">LJ</a>&nbsp;
<a href="../phrases/contents.htm">Phr</a>&nbsp;
<a href="../dictionary/contents.htm">Dic</a>&nbsp;
<a href="../release/contents.htm">Rel</a>&nbsp;
<a href="../dictionary/vocabul.htm">Voc</a>&nbsp;
<a href="../dictionary/xmain.htm">!:</a>&nbsp;
<a href="../index.htm">Help</a>&nbsp;
User<hr><!--top jump end-->
<h1>Unicode - UTF-8, UTF-16 and UTF-32</h1>

<p>UTF-8, UTF-16 and UTF-32 are supported. UTF-8 is multibyte encoding for 8 bit data that includes all unicode code points and maps 7 bit ASCII unchanged. J continues to use the literal data type of 8 bits. When literal data is displayed it is treated as UTF-8.</p>

<p>In addition to support for UTF-8 there is UTF-16 which is based on wchar (16 bit literal data type).
See <a href="../dictionary/duco.htm">u:</a> for details.
UTF-16 is a variable length encoding in which each unicode code point in the range from U+0000 to U+FFFF consists 1 wchar
while each unicode code point in the range from U+10000 to U+10FFFF consists 2 wchars.
UTF-16 is used in interfacing with some external libraries such as Windows API. Also when working
with unicode data of code points below U+10000, UTF-16 is more convenient for manipulating unicode data when multibyte UTF-8 is awkward.</p>

<p>UTF-32 based on literal4 (4-byte literal data type) is also support.
See <a href="../dictionary/duco.htm">u:</a> for details.
Unlike UTF-8 and UTF-16 encoding, UTF-32 is a fixed length encoding in which each unicode code point is represented by one literal4 character.
UTF-32 is the most convenient encoding for manipulating unicode


<p>Standard library defines: ucp, uucp, ucpcount, and utf8. Script
~addons/convert/misc/unicode.ijs defines additional utilities.</p>

<p>There are good unicode and UTF-8 references on the web, for example: <a href="http://unicode.org/faq/utf_bom.html">FAQ - UTF-8, UTF-16, UTF-32 & BOM</a>
 and <a href="http://www.utf-8.com">www.utf-8.com</a>.</p>

<p>There are several related wiki pages, for example: 
<a href="http://code.jsoftware.com/wiki/Guides/UnicodeGettingStarted">UnicodeGettingStarted</a>.</p>

<h1>Operations on UTF-8 and UTF-16 data</h1>

Exception for the <a href="../dictionary/duco.htm">u:</a> verb, J Engine does not interpret bytes are UTF-8 or wchars are UTF-16 unicode code points.
For example applying # on UTF-8 encoded byte literals gives the number of bytes but not unicode code points.
Similarly applying # on UTF-16 encoded wchar gives the number of wchar but not unicode code points.
Other verbs such as {. and dyad $ can produce invalid unicode sequences. Converting UTF-8 and UTF-16 to UTF-32 before processing can avoid those pitfalls.

<h1>boxed display</h1>

<p>J805 has improved boxed display of UTF-8 with European or CJK (Chinese/Japanese/Korean) data.</p>

<p>Ascii takes 1 data byte and 1 display space.
European takes 2 data bytes and 1 display space.
CJK takes 3 data bytes and 2 display spaces (with correct font).</p>

<p>The mismatch in data bytes vs display space caused boxed display in previous releases to have misaligned vertical bars.</p>

<p>J805 does a better job aligning vertical bars as it takes into account this mismatch.</p>

<p>European is a simpler problem and is supported by most modern fixed pitch fonts.</p>

<p>CJK is more complicated and many fixed pitch fonts don't display them in
2 display spaces so boxed display won't align vertical bars.</p>

<p><b>unifont</b> is a fixed pitch font that works with boxed CJK display.
For Windows and Mac install the standard unifont ttf from: 
<a href="http://unifoundry.com/unifont.html">http://unifoundry.com/unifont.html</a>.
For linux, use apt-get (or similar) to install unifont from distro repos.</p>

<p>In J805 try:<pre>
<195 161{a.
<230 178 146{a.</pre></p>

<p>Pleasing boxed display depends on valid UTF-8 sequences in the unicode ranges that are handled. For example, unicode chars that require 3 display spaces or are not supported in unifont will
not have aligned vertical bars.</p>

<p>Windows console/powershell do not support UTF-8 (they use codepages) and will have problems
with UTF-8.</p>

<p><b>updated - August 2016 - J805</b></p>
<!--bottom jump start--><hr><a href="locked_scripts.htm">&gt;&gt;</a>&nbsp;
<a href="boxdraw.htm">&lt;&lt;</a>&nbsp;
<a href="../user/contents.htm">Usr</a>&nbsp;
<a href="../primer/contents.htm">Pri</a>&nbsp;
<a href="../jforc/contents.htm">JfC</a>&nbsp;
<a href="../learning/contents.htm">LJ</a>&nbsp;
<a href="../phrases/contents.htm">Phr</a>&nbsp;
<a href="../dictionary/contents.htm">Dic</a>&nbsp;
<a href="../release/contents.htm">Rel</a>&nbsp;
<a href="../dictionary/vocabul.htm">Voc</a>&nbsp;
<a href="../dictionary/xmain.htm">!:</a>&nbsp;
<a href="../index.htm">Help</a>&nbsp;
User<!--bottom jump end--></body>
</html>
